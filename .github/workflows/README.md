# GitHub Actions CI/CD Workflows

このディレクトリには、WorkRecアプリのCI/CDパイプラインを管理するGitHub Actionsワークフローが含まれています。

## ワークフロー概要

### 1. CI/CD Pipeline (`ci.yml`)
**トリガー:**
- `main`, `develop`, `release/**` ブランチへのプッシュ
- `main`, `develop` ブランチへのプルリクエスト

**実行内容:**
- **Unit Tests**: 全てのコミットでユニットテストを実行
- **Build**: デバッグ・リリース両方のAPKをビルド
- **Release**: `release/` プレフィックスのブランチでのみリリースを作成

**バージョン形式:** `YYYYMMDD` (例: `20240117`)

### 2. Pull Request Validation (`pr-validation.yml`)
**トリガー:**
- プルリクエストの作成・更新

**実行内容:**
- Lintチェック
- ユニットテスト
- デバッグビルド検証

### 3. Manual Release (`manual-release.yml`)
**トリガー:**
- 手動実行（GitHub UI から）

**実行内容:**
- カスタムリリースノートでの手動リリース作成
- バージョンサフィックス対応（例: `-hotfix`, `-beta`）

## リリースプロセス

### 自動リリース
1. `release/feature-name` のようなブランチを作成
2. 変更をコミット・プッシュ
3. CI/CDパイプラインが自動実行され、テスト・ビルド・リリースが行われる

### 手動リリース
1. GitHub の Actions タブに移動
2. "Manual Release" ワークフローを選択
3. "Run workflow" をクリック
4. リリースノートとオプションのバージョンサフィックスを入力
5. ワークフローを実行

## 成果物

各ワークフローは以下の成果物を生成します：

- **APKファイル**: デバッグ・リリース版
- **テスト結果**: ユニットテストレポート
- **Lint結果**: コード品質チェックレポート
- **GitHub Release**: リリースブランチまたは手動実行時

## 必要な権限

ワークフローが正常に動作するために、以下の権限が必要です：

- `GITHUB_TOKEN`: リリース作成とアーティファクトアップロード（自動提供）
- Repository の Actions 権限が有効化されている必要があります

## トラブルシューティング

### ビルドエラー
- Gradle キャッシュをクリアしてリトライ
- JDK バージョンの確認（JDK 11 を使用）

### リリース作成エラー
- ブランチ名が `release/` で始まっているか確認
- 同じタグが既に存在しないか確認

### テスト失敗
- ローカルでテストが通ることを確認
- 依存関係の問題がないか確認